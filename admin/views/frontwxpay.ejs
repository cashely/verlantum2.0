<!DOCTYPE html>
<html>
  <head>
    <title>云量科技</title>
    <script src="https://cdn.bootcss.com/jquery/1.8.0/jquery.min.js"></script>
    <script src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
    <link rel="stylesheet" href="/stylesheets/payment.css">
  </head>
  <script type="text/javascript">
      var fontSizeAuto = function () {
          var viewportWidth = document.documentElement.clientWidth;
          if (viewportWidth > 640) { viewportWidth = 640; }
          if (viewportWidth < 320) { viewportWidth = 320; }
          document.documentElement.style.fontSize = viewportWidth / 6.4 + 'px';
      }
      fontSizeAuto();
      window.onresize = fontSizeAuto;
  </script>
  <body>
    <div class="alipay payment">
        <img src="/images/wechat.png" alt="">
        <p class="pay_state">正在支付中...</p>
        <div class="phone">
            <p>感谢您选择云量科技</p>
        </div>
        <div class="official_account">
            <p>微信公众号：云量检测</p>
        </div>
    </div>
    <script>
      function onBridgeReady(){
         WeixinJSBridge.invoke(
            'getBrandWCPayRequest', {
               "appId":"<%= appId%>",     //公众号名称，由商户传入
               "timeStamp":"<%= timeStamp%>",         //时间戳，自1970年以来的秒数
               "nonceStr":"<%= nonceStr%>", //随机串
               "package":"prepay_id=<%= prepayId%>",
               "signType":"MD5",         //微信签名方式：
               "paySign":"<%= sign%>" //微信签名
            },
            function(res){
            if(res.err_msg == "get_brand_wcpay_request:ok" ){
              // alert(res.err_msg)
            // 使用以上方式判断前端返回,微信团队郑重提示：
                  //res.err_msg将在用户支付成功后返回ok，但并不保证它绝对可靠。
            }
         });
      }
      if (typeof WeixinJSBridge == "undefined"){
         if( document.addEventListener ){
             document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);
         }else if (document.attachEvent){
             document.attachEvent('WeixinJSBridgeReady', onBridgeReady);
             document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);
         }
      }else{
         onBridgeReady();
      }
    </script>
  </body>
</html>
